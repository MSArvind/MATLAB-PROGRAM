clc;
clear all;
e1=21*10^3;
e2=1.2*10^3;
g12=0.7*10^3;
u12=0.3;
u21=e2*u12/e1
q11=e1/1-(u12*u21)
q22=e2/1-(u12*u21)
q12=u21*e1/1-(u12*u21)
q66=g12
Q=[q11 q12 0;q12 q22 0;0 0 q66]
f1t=250;
f1c=250;
f2t=8;
f2c=30;
f6=10;
for x=[0 25 65 -65 -25 -25 -65 65 25 0]
M=cosd(x);
e=sind(x);
qxx=M^4*q11+2*M^2*e^2*q12+e^4*q22+4*M^2*e^2*q66
qxy=M^2*e^2*q11+M^4*e^4*q12+M^2*e^2*q22-4*M^2*e^2*q66
qxs=M^3*e*q11+M*e^3-M^3*e*q12-M*e^3*q22+2*(M*e^3-M^3*e)*q66
qyy=e^4*q11+2*M^2*e^2*q12+M^4*q22+4*M^2*e^2*q66
qys=2*M*e^3*q11+M^3*e-M*e^3*q12+-M^3*e*q22+2*M^3*e-M*e^3*q66
qss=M^2*e^2*q11-2*M^2*e^2*q12+M^2*e^2*q22+(M^2-e^2)^2*q66 
q=[qxx qxy qxs;qxy qyy qys;qxs qys qss]%[Q]xyz 
end
q0=[2.1000*10^4 0 0;0 1.2000*10^3 0;0 0 700]
q25=[1.4723*10^4 2.8538e+03 6.0669e+03;2.8538e+03 1.9959e+03 2.4241e+03;6.0669e+03 2.4241e+03 3.4405e+03]
q65=[1.9959e+03 2.8538e+03 1.3794e+03;2.8538e+03 1.4723e+04 1.2798e+04;1.3794e+03 1.2798e+04  3.4405e+03]
qn65=[1.9959e+03 2.8538e+03 -1.3794e+03;2.8538e+03 1.4723e+04 -1.2798e+04;-1.3794e+03 -1.2798e+04  3.4405e+03]
qn25=[1.4723*10^4 2.8538e+03 -6.0669e+03;2.8538e+03 1.9959e+03 -2.4241e+03;-6.0669e+03 -2.4241e+03 3.4405e+03]
h1=[0.05;0.04;0.03;0.02;0.01;0.0;-0.01;-0.02;-0.03;-0.04]
h2=[0.04;0.03;0.02;0.01;0.00;-0.01;-0.02;-0.03;-0.04;-0.05]
h3=h1-h2
h4=h1.^2-h2.^2
h5=h1.^3-h2.^3
A11=(q0(1)*h3(1)+q25(1)*h3(2)+q65(1)*h3(3)+qn65(1)*h3(4)+qn25(1)*h3(5)+q0(1)*h3(10)+q25(1)*h3(9)+q65(1)*h3(8)+qn65(1)*h3(7)+qn25(1)*h3(6))
A12=(q0(2)*h3(1)+q25(2)*h3(2)+q65(2)*h3(3)+qn65(2)*h3(4)+qn25(2)*h3(5)+q0(2)*h3(10)+q25(2)*h3(9)+q65(2)*h3(8)+qn65(2)*h3(7)+qn25(2)*h3(6))
A13=(q0(3)*h3(1)+q25(3)*h3(2)+q65(3)*h3(3)+qn65(3)*h3(4)+qn25(3)*h3(5)+q0(3)*h3(10)+q25(3)*h3(9)+q65(3)*h3(8)+qn65(3)*h3(7)+qn25(3)*h3(6))
A22=(q0(5)*h3(1)+q25(5)*h3(2)+q65(5)*h3(3)+qn65(5)*h3(4)+qn25(5)*h3(5)+q0(5)*h3(10)+q25(5)*h3(9)+q65(5)*h3(8)+qn65(5)*h3(7)+qn25(5)*h3(6))
A23=(q0(6)*h3(1)+q25(6)*h3(2)+q65(6)*h3(3)+qn65(6)*h3(4)+qn25(6)*h3(5)+q0(6)*h3(10)+q25(6)*h3(9)+q65(6)*h3(8)+qn65(6)*h3(7)+qn25(6)*h3(6))
A66=(q0(9)*h3(1)+q25(9)*h3(2)+q65(9)*h3(3)+qn65(9)*h3(4)+qn25(9)*h3(5)+q0(9)*h3(10)+q25(9)*h3(9)+q65(9)*h3(8)+qn65(9)*h3(7)+qn25(9)*h3(6))
B11=(q0(1)*h4(1)+q25(1)*h4(2)+q65(1)*h4(3)+qn65(1)*h4(4)+qn25(1)*h4(5)+q0(1)*h4(10)+q25(1)*h4(9)+q65(1)*h4(8)+qn65(1)*h4(7)+qn25(1)*h4(6))
B12=(q0(2)*h4(1)+q25(2)*h4(2)+q65(2)*h4(3)+qn65(2)*h4(4)+qn25(2)*h4(5)+q0(2)*h4(10)+q25(2)*h4(9)+q65(2)*h4(8)+qn65(2)*h4(7)+qn25(2)*h4(6))
B13=(q0(3)*h4(1)+q25(3)*h4(2)+q65(3)*h4(3)+qn65(3)*h4(4)+qn25(3)*h4(5)+q0(3)*h4(10)+q25(3)*h4(9)+q65(3)*h4(8)+qn65(3)*h4(7)+qn25(3)*h4(6))
B22=(q0(5)*h4(1)+q25(5)*h4(2)+q65(5)*h4(3)+qn65(5)*h4(4)+qn25(5)*h4(5)+q0(5)*h4(10)+q25(5)*h4(9)+q65(5)*h4(8)+qn65(5)*h4(7)+qn25(5)*h4(6))
B23=(q0(6)*h4(1)+q25(6)*h4(2)+q65(6)*h4(3)+qn65(6)*h4(4)+qn25(6)*h4(5)+q0(6)*h4(10)+q25(6)*h4(9)+q65(6)*h4(8)+qn65(6)*h4(7)+qn25(6)*h4(6))
B66=(q0(9)*h4(1)+q25(9)*h4(2)+q65(9)*h4(3)+qn65(9)*h4(4)+qn25(9)*h4(5)+q0(9)*h4(10)+q25(9)*h4(9)+q65(9)*h4(8)+qn65(9)*h4(7)+qn25(9)*h4(6))
D11=(q0(1)*h5(1)+q25(1)*h5(2)+q65(1)*h5(3)+qn65(1)*h5(4)+qn25(1)*h5(5)+q0(1)*h5(10)+q25(1)*h5(9)+q65(1)*h5(8)+qn65(1)*h5(7)+qn25(1)*h5(6))
D12=(q0(2)*h5(1)+q25(2)*h5(2)+q65(2)*h5(3)+qn65(2)*h5(4)+qn25(2)*h5(5)+q0(2)*h5(10)+q25(2)*h5(9)+q65(2)*h5(8)+qn65(2)*h5(7)+qn25(2)*h5(6))
D13=(q0(3)*h5(1)+q25(3)*h5(2)+q65(3)*h5(3)+qn65(3)*h5(4)+qn25(3)*h5(5)+q0(3)*h5(10)+q25(3)*h5(9)+q65(3)*h5(8)+qn65(3)*h5(7)+qn25(3)*h5(6))
D22=(q0(5)*h5(1)+q25(5)*h5(2)+q65(5)*h5(3)+qn65(5)*h5(4)+qn25(5)*h5(5)+q0(5)*h5(10)+q25(5)*h5(9)+q65(5)*h5(8)+qn65(5)*h5(7)+qn25(5)*h5(6))
D23=(q0(6)*h5(1)+q25(6)*h5(2)+q65(6)*h5(3)+qn65(6)*h5(4)+qn25(6)*h5(5)+q0(6)*h5(10)+q25(6)*h5(9)+q65(6)*h5(8)+qn65(6)*h5(7)+qn25(6)*h5(6))
D66=(q0(9)*h5(1)+q25(9)*h5(2)+q65(9)*h5(3)+qn65(9)*h5(4)+qn25(9)*h5(5)+q0(9)*h5(10)+q25(9)*h5(9)+q65(9)*h5(8)+qn65(9)*h5(7)+qn25(9)*h5(6))
A=[A11 A12 A13;A12 A22 A23;A13 A23 A66]
B=[B11 B12 B13;B12 B22 B23;B13 B23 B66]
D=[D11 D12 D13;D12 D22 D23;D13 D23 D66]
ABD=[A B;B D]
abd=inv(ABD)
NM=[0.001;0;0;0;0;0]
ek=abd*NM
e=[ek(1);ek(2);ek(3)]
my=[ek(4);ek(5);ek(6)]
xyz0=q0*(e+h1(1)*my)
xyz25=q25*(e+h1(2)*my)
xyz65=q65*(e+h1(3)*my)
xyzn65=qn65*(e+h1(4)*my)
xyzn25=qn25*(e+h1(5)*my)
axyzn25=qn25*(e+h1(6)*my)
axyzn65=qn65*(e+h1(7)*my)
axyz65=q65*(e+h1(8)*my)
axyz25=q25*(e+h1(9)*my)
axyz0=q0*(e+h1(10)*my)
for x=[0 25 65 -65 -25 -25 -65 65 25 0]
    m=cosd(x)
    n=sind(x)
    t=[m^2 n^2 2*m*n;n^2 m^2 -2*m*n;-m*n m*n m^2-n^2]
    xyz01=t*xyz0
    xyz251=t*xyz25
    xyz651=t*xyz65
    xyzn651=t*xyzn65
    xyzn251=t*xyzn25
    xyzn252=t*axyzn25
    xyzn652=t*axyzn65
    xyz652=t*axyz65
    xyz252=t*axyz25
    xyz02=t*axyz0
end



   


    
